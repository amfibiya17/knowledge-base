# 4.06 Portals

Portals are a React feature that let you **render a component
outside of its parent DOM hierarchy**.

They are used when **visual placement in the DOM matters**
more than component hierarchy.

---

## What a Portal is

Normally, React renders components **inside their parent DOM node**.

With a portal, React renders a component:

- in a **different place in the DOM**
- while keeping it **logically part of the same React tree**

Key idea:

> Portals change **where** something is rendered in the DOM,  
> not **how** React works.

---

## Basic syntax

```jsx
ReactDOM.createPortal(children, container);
```

In React 18, `createPortal` is imported from `react-dom`, not `react-dom/client`.

Example:

```jsx
ReactDOM.createPortal(<Modal />, document.getElementById("modal-root"));
```

Modal is part of the React app  
but it is rendered inside `#modal-root`.

---

## Why Portals exist

Some UI elements should not live inside normal layout flow.

Problems without portals:

- `overflow: hidden` cuts off modals
- `z-index` becomes hard to manage
- tooltips get clipped
- dropdowns break inside containers

Portals solve these problems.

---

## Common use cases

Portals are commonly used for:

- modals
- dialogs
- tooltips
- dropdown menus
- popovers
- notifications / toasts

These components need to appear above everything else.

---

## Simple example (conceptual)

### HTML

```html
<div id="root"></div>
<div id="modal-root"></div>
```

### React

```jsx
function Modal({ children }) {
  return ReactDOM.createPortal(
    <div className="modal">{children}</div>,
    document.getElementById("modal-root")
  );
}
```

### Usage

```jsx
<Modal>
  <h1>Delete item?</h1>
</Modal>
```

The modal renders outside the main app DOM,
but still behaves like a normal React component.

---

## Important: Portals do NOT break React logic

Even though the DOM position is different:

- props still work
- state still works
- context still works
- events still bubble through React

Example:

- clicking inside a portal
- can trigger handlers in parent components

Because **React tree ≠ DOM tree**.

---

## Mental model

- React tree → logic and state
- DOM tree → visual placement
- Portals → control DOM placement without breaking React logic

Think:

> “Render here visually, but belong there logically.”

---

## Portals vs Conditional Rendering

Portals are not about showing or hiding components.

They are about:

- **where** something is rendered

You still use conditional rendering to control visibility:

```jsx
{
  isOpen && <Modal />;
}
```

---

## When to use Portals

Use portals when:

- an element must escape parent layout
- `z-index` or `overflow` causes issues
- UI must appear above everything else

---

## When NOT to use Portals

Avoid portals when:

- normal layout works fine
- the component belongs naturally in the DOM
- you are trying to “fix” bad CSS structure

Portals solve **DOM problems**, not design problems.

---

## Common mistakes

- using portals everywhere
- forgetting to create the portal root
- assuming portals isolate events
- using portals instead of fixing layout issues

---

## Summary

- Portals let you render components outside parent DOM nodes
- They do not break state, props, or context
- They are ideal for modals and overlays
- React tree stays the same, DOM position changes
- Use portals intentionally, not by default
