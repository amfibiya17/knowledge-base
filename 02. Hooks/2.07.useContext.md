# 2.07 useContext

This file introduces the `useContext` hook.  
`useContext` is used to **share data across components** without passing props through every level.

---

## What `useContext` is

`useContext` is a React hook that allows a component to:

- read data from a context
- subscribe to context changes
- avoid prop drilling

It provides a way to share **global or shared state** within part of the component tree.

---

## The problem `useContext` solves (prop drilling)

Without context, data must be passed manually through every component level.

Example problem:

```jsx
<App>
  <Layout>
    <Header>
      <UserMenu user={user} />
    </Header>
  </Layout>
</App>
```

Here:

- `user` is needed only by `UserMenu`
- but it must be passed through `Layout` and `Header`
- intermediate components don’t use it

This is called prop **drilling**.

---

## What a context is

A context is a container for a value that can be read by many components.

A context has two main parts:

- a **Provider** → supplies the value
- a **Consumer** → reads the value (via useContext)

---

## Creating a context

```jsx
import { createContext } from "react";

const ThemeContext = createContext("light");
```

Here:

- `ThemeContext` is created
- `"light"` is the default value (used only if no provider exists)

---

## Providing context value

```jsx
function App() {
  return (
    <ThemeContext.Provider value="dark">
      <Layout />
    </ThemeContext.Provider>
  );
}
```

Here:

- ThemeContext.Provider wraps part of the tree
- all child components can access "dark"

---

## Reading context with useContext

```jsx
import { useContext } from "react";

function Header() {
  const theme = useContext(ThemeContext);

  return <div>Theme: {theme}</div>;
}
```

Here:

- `useContext` reads the nearest **Provider** value
- the component re-renders when the value changes

---

## What happens when context value changes

- Provider value changes
- all consuming components re-render
- UI reflects the new context value

Context updates **flow down the component tree**.

---

## When to use `useContext`

Use `useContext` when:

- many components need the same data
- prop drilling becomes noisy
- data is truly shared

Common use cases:

- theme (dark / light)
- authentication / user data
- locale / language
- feature flags

---

## When NOT to use `useContext`

### Rule of thumb

- If data changes often → **avoid context**
- If data is shared and changes rarely → **context fits well**

Do **NOT** use `useContext` for:

- frequently changing data (high-frequency updates)
- deeply nested state logic
- replacing all props

Context is **not a state management replacement**.

---

## `useContext` and performance

Important to know:

- every context update re-renders all consumers
- context is not selective by default
- large contexts can cause unnecessary re-renders

### Context value identity (important)

Context compares values by **reference**, not by deep equality.

This means:

- passing new objects or functions creates a new reference
- all consumers will re-render, even if the data looks the same

This is why context values are often memoised.

Often combined with:

- `useMemo`
- splitting contexts
- memoised components

---

## What `useContext` does NOT do

- It does not store state by itself
- It does not replace `useState` or `useReducer`
- It does not prevent re-renders
- It does not eliminate the need for good state design

---

## Common mistakes

- Putting too much data into one context
- Using context instead of props everywhere
- Expecting context to behave like Redux
- Forgetting that all consumers re-render on change
- Using context for state that belongs locally

---

## Mental model

- Context → shared value container
- Provider → supplies the value
- `useContext` → reads the value
- Value changes → all consumers update

Context = **implicit props**.

---

## Summary

- `useContext` shares data without prop drilling
- Context has Provider + consumers
- All consumers re-render when value changes
- Best for truly shared data
- Not a replacement for state or props
- Use sparingly and intentionally
